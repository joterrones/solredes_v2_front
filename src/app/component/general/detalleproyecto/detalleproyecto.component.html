<mat-horizontal-stepper [linear]="false" #stepper>
  <mat-step>
    <ng-template matStepLabel>Datos del Proyecto</ng-template>
    <div class="contenedor">

      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Nombre del Proyecto</strong> </p>
        {{proyecto.c_nombreproyecto}}
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Código MEM</strong> </p>
        <p>{{proyecto.c_codigomem}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Código CUI</strong> </p>
        <p>{{proyecto.c_codigocui}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Código SNIP</strong> </p>
        <p>{{proyecto.c_codigosnip}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Objetivo</strong> </p>
        <p>{{proyecto.c_objetivoproyecto}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Unidad Ejecutora</strong> </p>
        <p>{{proyecto.c_unidadejecutora}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Unidad Formuladora</strong> </p>
        <p>{{proyecto.c_unidadformuladora}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Tipo de Ejecución</strong> </p>
        <p>{{proyecto.c_tipoejecucion}}</p>
      </div>
      <div style="width: 350px;">
        <p style="color: #303F9F;"><strong>Fondo de Financiamiento</strong> </p>
        <p>{{proyecto.c_fuentefinanciamiento}}</p>
      </div>
    </div>
    <h4>Ubicación ({{proyecto.c_fase}}): Departamentos: {{ubigeo1}} Provincias: {{ubigeo2}} Distritos: {{ubigeo3}}</h4>
    <mat-card-actions>
      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="1"
        [titulo]="'Ficha E. Preinversión'"></app-exportperfilxls>
      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="2" [titulo]="'Ficha E. Definitivo'">
      </app-exportperfilxls>
      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="3" [titulo]="'Ficha Ejecución'">
      </app-exportperfilxls>
      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="5" [titulo]="'Ficha Supervisión'">
      </app-exportperfilxls>
      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="6" [titulo]="'Ficha Ejec. Otros'">
      </app-exportperfilxls>
      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="4" [titulo]="'Ficha Cierre'">
      </app-exportperfilxls>
      <app-export-control-obra-xls [n_idgen_proyecto]="proyecto.n_idgen_proyecto"></app-export-control-obra-xls>
      <app-export-control-supervisor [n_idgen_proyecto]="proyecto.n_idgen_proyecto"></app-export-control-supervisor>

      <app-exportperfilxls [n_idgen_proyecto]="proyecto.n_idgen_proyecto" [excel]="7" [titulo]="'Relación de Localidades'">
      </app-exportperfilxls>
    </mat-card-actions>

  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Datos Adicionales</ng-template>
    <mat-tab-group>
      <div *ngFor="let fase of fases">
        {{fase.c_nombre}}
        <mat-tab>
          <ng-template mat-tab-label>
            <span (click)="changetab(fase.n_idgen_fase)">{{fase.c_nombre}}</span>
          </ng-template>
          <table mat-table [dataSource]="tablaatributo" matSort class="mat-elevation-z8">
            <ng-container matColumnDef="nombreatributo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                <p style="color: black;"><strong>Descripción </strong></p>
              </th>
              <td mat-cell *matCellDef="let element">
                <p style="color: black;">{{element.c_atributo  }} ({{element.c_unidad}})</p>
              </td>
            </ng-container>
            <ng-container matColumnDef="valoratributo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                <p style="color: black;"><strong>Valor del Archivo </strong></p>
              </th>
              <td mat-cell *matCellDef="let element">
                <div [hidden]="element.c_tipodato=='file'">
                  {{element.c_valoratributo}}
                </div>
                <div [hidden]="element.c_tipodato!='file'">
                  <p style="color: blue;">{{element.c_valoratributo}}

                    <button mat-mini-fab color="accent" aria-label="Example icon button with a plus one icon"
                      style="margin-left: 10px;" (click)="download(element.c_valoratributo)">
                      <mat-icon>get_app</mat-icon>
                    </button>
                  </p>
                </div>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumnsAtributo"></tr>
            <ng-template let-row matRowDef cdkVirtualFor [matRowDefColumns]="displayedColumnsAtributo">
              <tr mat-row></tr>
            </ng-template>
          </table>
        </mat-tab>
      </div>
    </mat-tab-group>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Tareas Vencidas</ng-template>
    <table mat-table [dataSource]="tabla" matSort class="mat-elevation-z8">

      <ng-container matColumnDef="tarea">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <p style="color: black;"><strong>Tarea </strong></p>
        </th>
        <td mat-cell *matCellDef="let element" style="font-size: 10px;">
          <p><strong>{{element.c_fase  }}</strong></p>
          <p style="color: blue;">{{element.c_valoractividad  }}</p>
          <p>{{element.c_descripciontarea  }}</p>
        </td>
      </ng-container>
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <p style="color: black;"><strong>Fecha Programada </strong></p>
        </th>
        <td mat-cell *matCellDef="let element"> {{element.d_fechaprogramada}} </td>
      </ng-container>
      <ng-container matColumnDef="dias">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <p style="color: black;"><strong> Retrazo </strong></p>
        </th>
        <td mat-cell *matCellDef="let element">
          <p style="color: red;"><strong>{{element.n_anoatrasados}} años</strong></p>
          <p style="color: red;"><strong>{{element.n_mesatrasados}} meses</strong></p>
          <p style="color: red;"><strong>{{element.n_diaatrasados}} días </strong></p>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <ng-template let-row matRowDef cdkVirtualFor [matRowDefColumns]="displayedColumns">
        <tr mat-row></tr>
      </ng-template>
    </table>
  </mat-step>
</mat-horizontal-stepper>