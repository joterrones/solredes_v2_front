<app-menu>
  <div class="contenedorBody">
    <h2> MAPA Y EXPORTACION</h2>

    <mat-accordion>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Filtros y Exportaci√≥n de Datos
          </mat-panel-title>
          <mat-panel-description>
            Pulsar para desplegar las opciones
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="contenedorfiltro">
          <mat-form-field>
            <mat-select placeholder="Fases">
              <mat-option value="0" (click)='selectFase(0)'>
                -TODOS-
              </mat-option>
              <mat-option *ngFor="let fase of fases" [value]="fase.n_idgen_fase"
                (click)='selectFase(fase.n_idgen_fase)'>
                {{fase.c_nombre}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-select placeholder="Departamentos">
              <mat-option value="0" (click)="selectDepartamento(0)">
                -TODOS-
              </mat-option>
              <mat-option value="-100" (click)="selectDepartamento(-100)">
                -SIN ASIGNAR-
              </mat-option>
              <mat-option *ngFor="let item of departamentos" [value]="item.n_idgen_departamento" (click)="selectDepartamento(item.n_idgen_departamento)">
                {{item.c_nombre}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field>
            <mat-select placeholder="Provincias">
              <mat-option value="0" (click)="selectProvincia(0)">
                -TODOS-
              </mat-option>
              <mat-option *ngFor="let item of provincias" [value]="item.n_idgen_provincia" (click)="selectProvincia(item.n_idgen_provincia)">
                {{item.c_nombre}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field>
            <mat-select placeholder="Distritos"  (click)="selectDistrito(0)">
              <mat-option *ngFor="let item of distritos" [value]="item.n_idgen_distrito" (click)="selectDistrito(item.n_idgen_distrito)">
                {{item.c_nombre}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field>
            <mat-select placeholder="Centros Poblados" (click)="selectCentroPoblado(0)">
              <mat-option *ngFor="let item of centropoblados" [value]="item.n_idgen_centropoblado" (click)="selectCentroPoblado(item.n_idgen_centropoblado)">
                {{item.c_nombre}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
    <mat-card>
      <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom" [mapTypeControl]='true' [mapTypeId]="'hybrid'">
        <agm-marker-cluster [maxZoom]="18" imagePath="http://35.184.146.235/Multimedia/Nama/images/m">
          <agm-marker *ngFor="let marker of markers " [latitude]="marker.lat" [longitude]="marker.lng"
            [opacity]="marker.alpha" [iconUrl]="
                {
                  url:  './assets/mapa/icono-PROYECTO.svg' ,
                  scaledSize: {
                    width: 60,
                    height: 90
                }
              }" (markerClick)="openDialog(marker.data)"  (mouseOver)="onMouseOver(infoWindow, $event)"     (mouseOut)="onMouseOut(infoWindow, $event)">
              <agm-info-window [disableAutoPan]="false" #infoWindow>
                <div>
                    <p><strong>Proyecto:</strong> {{marker.data.c_nombreproyecto}}</p>
                    <p><strong>Estado:</strong> {{marker.data.c_fase}}</p>
                </div>
            </agm-info-window>
          </agm-marker>
        </agm-marker-cluster>
      </agm-map>
    </mat-card>

  </div>

</app-menu>